<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>闭包内存泄露</title>
</head>

<body>
  <button id="click">click</button>
  <h1 id="content"></h1>

  <script>
    let click = document.querySelector("#click");
    let content = document.querySelector("#content")
    let arr = []

    function closures() {
      return new Array(1000).fill('isboyjc')
      let test = new Array(1000).fill('isboyjc')

      return function () {
        return test
      }
    }

    click.addEventListener("click", function () {
      arr.push(...closures())
      arr.push(...closures())
      console.log('/closure.html [28]--1',closures(),arr);

      content.innerHTML = arr.length
    });

    // 闭包块级作用域
    for(var i=0;i<5;i++) {
      let j = i;
      setTimeout(()=>{
        console.log(j)
      },j*1000)
    }

    for(let i=0;i<5;i++) {
      setTimeout(()=>{
        console.log(i)
      },i*1000)
    }
  </script>
</body>

</html>
